<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Panel de Administraci√≥n</title>
	<link rel="stylesheet" href="{{ url_for('static', filename='Styles.css') }}">
</head>
<body>
	<div class="barra-superior">
		<div class="menu-icono" onclick="window.location='{{ url_for('index') }}'">‚üµ</div>
		Panel de Administraci√≥n
		<div style="margin-left:auto; padding-right:16px;">
			<a href="{{ url_for('logout') }}">Cerrar sesi√≥n</a>
		</div>
	</div>

	<div class="container" style="padding-top: 100px;">
		{% with messages = get_flashed_messages(with_categories=true) %}
			{% if messages %}
				<div class="flash-messages">
					{% for category, message in messages %}
						<div class="flash-message flash-{{ category }}">{{ message }}</div>
					{% endfor %}
				</div>
			{% endif %}
		{% endwith %}

		<!-- Panel de Control -->
		<div class="dashboard-panel">
			<h2 style="margin-bottom: 20px;">Panel de Control</h2>
			<div class="stats-grid">
				<div class="stat-card">
					<div class="stat-icon">üì¶</div>
					<div class="stat-info">
						<div class="stat-value">{{ stats.get('total_productos', 0) }}</div>
						<div class="stat-label">Total de Productos</div>
					</div>
				</div>
				<div class="stat-card">
					<div class="stat-icon">‚è≥</div>
					<div class="stat-info">
						<div class="stat-value">{{ stats.get('pedidos_pendientes', 0) }}</div>
						<div class="stat-label">Pedidos Pendientes</div>
					</div>
				</div>
				<div class="stat-card">
					<div class="stat-icon">üìä</div>
					<div class="stat-info">
						<div class="stat-value">{{ stats.get('total_pedidos', 0) }}</div>
						<div class="stat-label">Total Pedidos</div>
					</div>
				</div>
			</div>
		</div>

		<!-- Secci√≥n de categor√≠as removida seg√∫n requerimiento -->

		<h2>Gestionar Productos</h2>
		<div class="admin-section">
			<form method="POST" action="{{ url_for('admin_productos_crear') }}" class="admin-form">
				<input type="text" name="nombre" placeholder="Nombre del producto" required>
				<select name="categoria" required style="padding: 10px; border-radius: 5px; border: 1px solid #ddd;">
					<option value="">Seleccionar categor√≠a</option>
					<option value="desayunos">Desayunos</option>
					<option value="almuerzos">Almuerzos</option>
					<option value="cenas">Cenas</option>
					<option value="meriendas">Meriendas</option>
					<option value="postres">Postres</option>
					<option value="bebidas">Bebidas</option>
					<option value="promociones">Promociones</option>
				</select>
				<input type="text" name="imagen" placeholder="URL de imagen" required>
				<input type="number" name="precio" placeholder="Precio" step="0.01" required>
				<textarea name="descripcion" placeholder="Ingredientes y descripci√≥n" style="padding: 10px; border-radius: 5px; border: 1px solid #ddd; min-height: 80px;"></textarea>
				<button type="submit">Agregar producto</button>
			</form>
			<table class="admin-table">
				<thead>
					<tr><th>ID</th><th>Nombre</th><th>Categor√≠a</th><th>Imagen</th><th>Precio</th><th>Acciones</th></tr>
				</thead>
				<tbody>
					{% for p in productos %}
					<tr>
						<td>{{ p[0] }}</td>
						<td>
						<form method="POST" action="{{ url_for('admin_productos_actualizar', producto_id=p[0]) }}" class="inline-form">
								<input type="text" name="nombre" value="{{ p[1] }}" required>
								<select name="categoria" required style="padding: 8px; border-radius: 5px; border: 1px solid #ddd;">
									<option value="desayunos" {% if p[3] == 'desayunos' %}selected{% endif %}>Desayunos</option>
									<option value="almuerzos" {% if p[3] == 'almuerzos' %}selected{% endif %}>Almuerzos</option>
									<option value="cenas" {% if p[3] == 'cenas' %}selected{% endif %}>Cenas</option>
									<option value="meriendas" {% if p[3] == 'meriendas' %}selected{% endif %}>Meriendas</option>
									<option value="postres" {% if p[3] == 'postres' %}selected{% endif %}>Postres</option>
									<option value="bebidas" {% if p[3] == 'bebidas' %}selected{% endif %}>Bebidas</option>
									<option value="promociones" {% if p[3] == 'promociones' %}selected{% endif %}>Promociones</option>
								</select>
								<input type="text" name="imagen" value="{{ p[4] or '' }}" required>
								<input type="number" name="precio" value="{{ '%.2f' % p[2] }}" step="0.01" required>
								<textarea name="descripcion" style="padding: 8px; border-radius: 5px; border: 1px solid #ddd; min-height: 60px;">{{ p[5] or '' }}</textarea>
								<button type="submit">Guardar</button>
							</form>
						</td>
						<td>
							<form method="POST" action="{{ url_for('admin_productos_eliminar', producto_id=p[0]) }}" onsubmit="return confirm('¬øEliminar producto?')">
								<button type="submit" class="btn-danger">Eliminar</button>
							</form>
						</td>
					</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>

		<h2>Pedidos</h2>
		<div style="margin-bottom: 20px;">
			<a href="{{ url_for('admin_pedidos_list') }}" style="display: inline-block; padding: 10px 20px; background: #713D2A; color: white; text-decoration: none; border-radius: 5px; font-weight: bold;">Ver Todos los Pedidos</a>
		</div>
	</div>
</body>
</html>
